---
id: TSK-010
title: Create notification router with list endpoint
status: pending
parent_ticket: TKT-002
estimate: M
type: implementation
dependencies:
  depends_on:
    - TSK-003
  blocks:
    - TSK-011
    - TSK-012
    - TSK-013
    - TSK-014
---

# TSK-010: Create notification router with list endpoint

## Objective

Create FastAPI router for notifications with GET /api/v1/notifications endpoint for listing user notifications.

## Context

Clients need to fetch notifications for display in the notification center with pagination and filtering.

## Deliverables

- [ ] `omoi_os/api/routes/notifications.py` - Notification router

## Implementation Notes

```python
# omoi_os/api/routes/notifications.py

from typing import Optional
from uuid import UUID

from fastapi import APIRouter, Depends, HTTPException, Query
from sqlalchemy.ext.asyncio import AsyncSession

from omoi_os.api.dependencies import get_db, get_current_user
from omoi_os.models.notification import Notification
from omoi_os.models.user import User
from omoi_os.services.notification_service import NotificationService
from omoi_os.schemas.notification import NotificationResponse, NotificationListResponse

router = APIRouter(prefix="/notifications", tags=["notifications"])

@router.get("", response_model=NotificationListResponse)
async def list_notifications(
    status: Optional[str] = Query(None, regex="^(all|read|unread)$"),
    type: Optional[str] = None,
    limit: int = Query(50, ge=1, le=100),
    offset: int = Query(0, ge=0),
    current_user: User = Depends(get_current_user),
    notification_service: NotificationService = Depends(get_notification_service),
):
    """List user notifications with pagination."""
    notifications, total = await notification_service.get_notifications(
        user_id=current_user.id,
        status=status,
        type=type,
        limit=limit,
        offset=offset,
    )

    unread_count = await notification_service.get_unread_count(current_user.id)

    return NotificationListResponse(
        notifications=[NotificationResponse.model_validate(n) for n in notifications],
        total=total,
        unread_count=unread_count,
    )
```

## Acceptance Criteria

- [ ] Router created at /api/v1/notifications
- [ ] GET endpoint returns paginated notifications
- [ ] Query parameters: status, type, limit, offset
- [ ] Response includes notifications, total, unread_count
- [ ] Only returns notifications for authenticated user
- [ ] Notifications ordered by created_at DESC

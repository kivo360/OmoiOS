---
id: TSK-004
title: Create Pydantic schemas for API contracts
status: pending
ticket_id: TKT-001
estimate: S
type: implementation
dependencies:
  depends_on: []
  blocks: [TSK-016]
---

# TSK-004: Create Pydantic schemas for API contracts

## Objective

Create Pydantic models for all consolidation API requests and responses including options, status, and results.

## Context

The API endpoints need properly validated request/response models. These Pydantic schemas define the contract for the consolidation API.

## Deliverables

- `backend/omoi_os/schemas/consolidation.py` - Consolidation Pydantic schemas

## Implementation Notes

```python
# omoi_os/schemas/consolidation.py
from pydantic import BaseModel, Field
from typing import List, Optional
from datetime import datetime
from uuid import UUID

class ConsolidationOptions(BaseModel):
    merge: bool = True
    summarize: bool = True
    archive: bool = True
    promote: bool = True
    similarity_threshold: float = Field(default=0.90, ge=0.0, le=1.0)
    min_cluster_size: int = Field(default=2, ge=2)
    archive_stale_days: int = Field(default=90, ge=1)
    archive_min_reuse: int = Field(default=3, ge=0)
    promote_confidence_threshold: float = Field(default=0.85, ge=0.0, le=1.0)

class TriggerConsolidationRequest(BaseModel):
    project_id: UUID
    options: Optional[ConsolidationOptions] = None

class TriggerConsolidationResponse(BaseModel):
    job_id: UUID
    status: str
    estimated_completion: Optional[datetime] = None

class ConsolidationStatusResponse(BaseModel):
    job_id: UUID
    project_id: UUID
    status: str
    progress: Optional[float] = None
    started_at: Optional[datetime] = None
    completed_at: Optional[datetime] = None
    memories_merged: int = 0
    memories_archived: int = 0
    memories_promoted: int = 0
    summaries_created: int = 0
    consolidation_changes: List[UUID] = []
    error_message: Optional[str] = None
```

## Acceptance Criteria

- [ ] ConsolidationOptions schema with validation
- [ ] TriggerConsolidationRequest/Response schemas
- [ ] ConsolidationStatusResponse schema
- [ ] RollbackRequest/Response schemas
- [ ] MemoryCluster schema
- [ ] ConsolidationResult schema
- [ ] All fields properly typed
- [ ] Validation rules applied (ranges, constraints)
- [ ] Schemas importable from omoi_os.schemas.consolidation

## Dependencies

**Depends On**: None
**Blocks**: TSK-016 (API endpoints)

## Estimate

**Size**: S (< 2 hours)

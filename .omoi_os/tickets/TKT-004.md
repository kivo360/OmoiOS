---
id: TKT-004
title: Email Notification Delivery
status: backlog
priority: MEDIUM
estimate: M
design_ref: designs/notification-system.md
requirements:
  - REQ-NOTIF-FUNC-008
dependencies:
  blocked_by:
    - TKT-001
  blocks: []
---

# TKT-004: Email Notification Delivery

## Description

Implement optional email delivery for notifications, allowing users to receive notification emails based on their preferences. This ticket assumes use of a transactional email service.

## Scope

### In Scope
- EmailNotificationService for sending notification emails
- Email template with consistent branding
- Retry logic with exponential backoff (3 attempts)
- Unsubscribe mechanism
- Integration with NotificationService

### Out of Scope
- Email service selection/configuration (to be determined)
- Rich HTML email templates
- Email preference management in email body

## Acceptance Criteria

- [ ] EmailNotificationService sends notification emails asynchronously
- [ ] Email includes notification title, message, and action link
- [ ] Email uses consistent branding template
- [ ] Failed email deliveries are retried up to 3 times with exponential backoff
- [ ] Email includes unsubscribe link
- [ ] Email delivery failures are logged
- [ ] Service respects user's email preference per notification type
- [ ] Integration tests verify email sending with mock service

## Technical Notes

- Email service selection deferred (SendGrid, AWS SES, Supabase email options)
- Use background task queue for async delivery
- Email templates stored in templates/ directory
- Unsubscribe token stored in user preferences

## Tasks

- TSK-022: Create EmailNotificationService interface
- TSK-023: Design email template
- TSK-024: Implement email sending with retry logic
- TSK-025: Add unsubscribe mechanism
- TSK-026: Integrate with NotificationService
- TSK-027: Write tests for email delivery

## Dependencies

**Blocked By**: TKT-001 (requires NotificationService to trigger emails)
**Blocks**: None

## Estimate

**Size**: M (2-4 hours)
**Rationale**: Email delivery is well-understood pattern. Main work is template design and retry logic.

## Open Questions

- [ ] Which email service should we use?
